<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Web Application Security Assessment Checklist</title>
<style type="text/css">
body{padding:2% 3% 3% 3%;font-family:Verdana;line-height:1.5em;background-color:black;color:white;}
a,.normal{text-decoration:none;color:#FFFFAA;}
a.list{text-decoration:none;font-weight:bold;}
a.note{text-decoration:none;font-style:italic;color:#D4FFD4;}
a.nav{color:gray;}
.toggle{text-decoration:none;font-size:13px!important;position:relative;top:-3px;color:gray;}
textarea{font-family:Arial;font-size:1em;} 
input[type=button]{background-color:transparent;color:white;border:1px solid;}
.strike{text-decoration: line-through;}
.c1{border-color:#7FAAFF;}
.c2{border-color:#AAFF55;}
.c3{border-color:#FFAA00;}
.c4{border-color:#D4FFAA;}
.c5{border-color:#00D4FF;}
.c6{border-color:#FF00FF;}
.c7{border-color:#00FF55;}
</style>
</head>

<body>
<div style="padding:2% 2% 2% 2%;background-image:url('bg.png');font-family:Georgia,Arial!important">
<h1>Web App Security Assessment Checklist</h1>
<h2>Methodology: <a  style="color:blue!important;" href="http://portswigger.net" target="_blank">WAHH v2</a></h2>
<div style="float:right;position:relative;top:-10px;"><a class="nav" href="owasp4.html">OWASP-TG v4</a></div>
</div>
</div>
<br/>
<span style="position:absolute;left:43%;top:40%;color:white;background-color:red" id="loading">&nbsp;Loading ... Please be patient!&nbsp;</span>
<br />
<div style="position: fixed; left: 87%; top: 91%; font-style: italic; font-size: 12px;">
</div>
<a name="start"></a>
<table width="51%" border="0" cellpadding="2" cellspacing="2" style="border:1px solid">
  <tr>
    <th width="30%" scope="col">&nbsp;</th>
    <th width="70%" scope="col">&nbsp;</th>
  </tr>
  <tr>
    <td>Target Site:</td>
    <td><input name="text" type="text" id="site" style="width:98%;font-weight:bold;" value="http://" /></td>
  </tr>
  <tr>
    <td>Pentester:</td>
    <td><input name="text2" type="text" id="pentester" style="width:80%;font-weight:bold;" value="YOURNAME" /></td>
  </tr>
  <tr>
    <td height="32">&nbsp;</td>
    <td><input type="button" disabled="disabled"  id="btnStatus" value="Check Overall Status" onclick="getstatus()" /> &nbsp;&nbsp;&nbsp;<input type="button" value="Generate Report" onclick="report()" id="btnReport" disabled="disabled" />
<span style="position:fixed;top:10%;left:87%;font-weight:bold;color:white;background-color:#669966" id="status"></span>
<br />&nbsp;</td>
  </tr>
</table>
<br/>

<input type="button" value="Reset" onclick="reset()" /> &nbsp; &nbsp;
<input type="button" value="Check all" onclick="checkall()" />&nbsp; &nbsp;
<input type="button" value="Add Custom Test" onclick="addnew()" />&nbsp; &nbsp;
<input type="button" value="Delete Test" onclick="deletetest()" />&nbsp; &nbsp;
<input type="button" value="Collapse all" onclick="if(this.value==='Collapse all'){togglecollapse(true);this.value='Hide all';}else{togglecollapse(false);this.value='Collapse all';}" />
<br/><br/>
<span style="font-size:12px">*Note: "Add/Delete Test" must be done first if you have plan to do so. Or else you'll lose your work.</a>
<br/><br/><strong><a href="javascript:void(0)" onclick="if($('exec_sum').style.display==='none'){$('exec_sum').style.display='';$('exec_sum').focus();}else{$('exec_sum').style.display='none';}">&#8224; Executive Summmary </a></strong><br/>
<span id="exec_sum_place"><textarea cols="85" rows="10" id="exec_sum" style="display:none"></textarea></span>
<p id="ck">Please wait...</p>
<a name="end"></a>
<script type="text/javascript">

// WAHH's
var lst = new Array(

// 1.1 Recon and analysis: Map the Application's Content
	"Map visible content","Consult public resources","Discover hidden content", "Discover default content","Enumerate identifier-specified Functions","Discover debug parameters",

// 1.2 Recon and analysis : Analyze the Application	
	"Identify functionality", "Identify data entry points","Identify the technologies used","Map the attack surface",
	
	
// 2. Client-Side Controls

"Test transmission of data via the client","Test client-side controls over user input","Check for DOM-based vulnerabilities (XSS,Open Redirection)","Check for frame injection (client-side:JavaScript Protection)", "Test browser extension components",


// 3.1 Access Handling: Authentication Mechanism 	
"Understand the authentication mechanism", "Test password quality","Test for username enumeration","Test resilience to password guessing","Test any account recovery function","Test any `remember me` function","Test any impersonation function","Test username uniqueness", "Test predictability of autogenerated credentials", "Check for unsafe transmission of credentials", "Check for unsafe distribution of credentials", "Test for fail-open conditions","Test any multi-stage mechanisms", "Exploit any vulnerabilities to gain unauthorized access",

// 3.2 Access Handling: Session Management Mechanism
"Understand the session management mechanism", "Test tokens for meaning","Test tokens for predictability","Check for insecure transmission of tokens","Check for disclosure of tokens in logs","Check mapping of tokens to sessions","Check session termination","Check for session fixation","Check for cross-site request forgery","Check cookie scope",

// 3.3 Access Handling: Access Controls
"Understand the access control requirements","Test with multiple accounts","Test with limited access","Test for insecure access control methods (request parameters, Referer header, etc)",

// 4. Input Handling: Input-based Vulnerabilities
"Fuzz all request parameters","Test for SQL injection","Identify reflected request parameters","Test for reflected XSS","Test for HTTP header injection","Test for open redirection","Test for stored attacks","Test for OS command injection","Test for path traversal","Test for script injection","Test for file inclusion", 

// 4. Input Handling: Function-Specific Input Vulnerabilities
"Test for SMTP injection","Test for native software vulnerabilities","Test for SOAP injection","Test for LDAP injection","Test for back-end request injection","Test for XPath injection", "Test for XXE injection",

// 5. Logic Flaws
"Identify key attack surface","Test multi-stage processes for logic flaws","Test handling of incomplete input","Test trust boundaries","Test transaction logic",

// 6. Aplication Hosting: Shared Hosting Vulnerabilities
"Test segregation in shared infrastructures","Test segregation between ASP-hosted applications",
	 
// 6. Aplication Hosting: Application Server Vulnerabilities
"Test for default credentials","Test for default content","Test for Dangerous HTTP methods","Test for Proxy functionality","Virtual hosting mis-configuration","Test for web server software bugs", "Test for web application firewalling", "Check for weak SSL ciphers", "Check for frame injection (server-side:X-Frame-Options)",

// 7. Miscelleneous check
"Decipher persistent cookies","Caching Directives (either response header or page source)","Sensitive data in URL parameters","Sensitive forms with autocomplete enabled","Browser plugins local storage (Java Applet:Registry, SiliverLight:File, Flash:File)",  "Check Same-Origin Policy Configuration", "Follow up any information leakage");


var lst_bak = new Array;
lst_bak=lst_bak.concat(lst);
 
var key = new Array();
var phase = new Array("Recon and analysis","Test handling of access : Authentication","Test handling of access : Session handling","Test handling of access : Access controls","Test handling of input","Test application logic" , "Assess application hosting","Miscellaneous tests");

// 1. Recon and analysis: Map the Application's Content
key["Map visible content"]=0;key["Consult public resources"]=0;key["Discover hidden content"]=0;key["Discover default content"]=0;key["Enumerate identifier-specified Functions"]=0;key["Discover debug parameters"]=0;

// 1. Recon and analysis : Analyze the Application
key["Identify functionality"]=1;key["Identify data entry points"]=1;key["Identify the technologies used"]=1;key["Map the attack surface"]=1;

// 2. Client-side controls
key["Test transmission of data via the client"]=2;key["Test client-side controls over user input"]=2;key["Check for DOM-based vulnerabilities (XSS,Open Redirection)"]=2;key["Check for frame injection (client-side:JavaScript Protection)"]=2; key["Test browser extension components"]=2;



// 3.1 Access Handling: Authentication Mechanism 	
key["Understand the authentication mechanism"]=3; key["Test password quality"]=3;key["Test for username enumeration"]=3;key["Test resilience to password guessing"]=3;key["Test any account recovery function"]=3;key["Test any `remember me` function"]=3;key["Test any impersonation function"]=3;key["Test username uniqueness"]=3; key["Test predictability of autogenerated credentials"]=3; key["Check for unsafe transmission of credentials"]=3; key["Check for unsafe distribution of credentials"]=3; key["Test for fail-open conditions"]=3;key["Test any multi-stage mechanisms"]=3; key["Exploit any vulnerabilities to gain unauthorized access"]=3;

// 3.2 Access Handling: Session Management Mechanism
key["Understand the session management mechanism"]=4; key["Test tokens for meaning"]=4;key["Test tokens for predictability"]=4;key["Check for insecure transmission of tokens"]=4;key["Check for disclosure of tokens in logs"]=4;key["Check mapping of tokens to sessions"]=4;key["Check session termination"]=4;key["Check for session fixation"]=4;key["Check for cross-site request forgery"]=4;key["Check cookie scope"]=4;

// 3.3 Access Handling: Access Controls
key["Understand the access control requirements"]=5;key["Test with multiple accounts"]=5;key["Test with limited access"]=5;key["Test for insecure access control methods (request parameters, Referer header, etc)"]=5;

// 4. Input Handling: Input-based Vulnerabilities
key["Fuzz all request parameters"]=6;key["Test for SQL injection"]=6;key["Identify reflected request parameters"]=6;key["Test for reflected XSS"]=6;key["Test for HTTP header injection"]=6;key["Test for open redirection"]=6;key["Test for stored attacks"]=6;key["Test for OS command injection"]=6;key["Test for path traversal"]=6;key["Test for script injection"]=6;key["Test for file inclusion"]=6; 


// 4. Input Handling: Function-Specific Input Vulnerabilities
key["Test for SMTP injection"]=7;key["Test for native software vulnerabilities"]=7;key["Test for SOAP injection"]=7;key["Test for LDAP injection"]=7;key["Test for back-end request injection"]=7;key["Test for XPath injection"]=7; key["Test for XXE injection"]=7;



// 5. Logic Flaws
key["Identify key attack surface"]=8;key["Test multi-stage processes for logic flaws"]=8;key["Test handling of incomplete input"]=8;key["Test trust boundaries"]=8;key["Test transaction logic"]=8;

// 6. Aplication Hosting: Shared Hosting Vulnerabilities
key["Test segregation in shared infrastructures"]=9; key["Test segregation between ASP-hosted applications"]=9;

	 
// 6. Aplication Hosting: Application Server Vulnerabilities
key["Test for default credentials"]=10;key["Test for default content"]=10;key["Test for Dangerous HTTP methods"]=10;key["Test for Proxy functionality"]=10;key["Virtual hosting mis-configuration"]=10;key["Test for web server software bugs"]=10; key["Test for web application firewalling"]=10; key["Check for weak SSL ciphers"]=10; key["Check for frame injection (server-side:X-Frame-Options)"]=10;

// 7. Miscelleneous check

key["Decipher persistent cookies"]=11;key["Caching Directives (either response header or page source)"]=11;key["Sensitive data in URL parameters"]=11;key["Sensitive forms with autocomplete enabled"]=11;key["Browser plugins local storage (Java Applet:Registry, SiliverLight:File, Flash:File)"]=11;  key["Check Same-Origin Policy Configuration"]=11; key["Follow up any information leakage"]=11;


var firstTime = true;
var data = "";
function $(id){return document.getElementById(id);} 

function populate()
{
var ck = $("ck");
ck.innerHTML = '';
var aa = false;var ab = false; var ac = false; 
var b=false;var c=false; var d = false;
var ea=false;var eb=false;
var f=false;var ga=false;var gb=false;
var h = false;var i = false;
	for (var i=0;i<=lst.length-1;i++)
	{	
		//console.log(i + ":" + lst[i] + ": " + key[lst[i]]);	
		switch(key[lst[i]])
		{			
			case 0:
			if(aa===false){
			data += '<fieldset class="c1"><legend>Phase 1</legend><h2>Phase 1. Recon and Analysis </h2><h4>Phase 1.1 Map the application&nbsp;&nbsp;<a class="toggle" href="javascript:void(0)" onclick="if($(\'phase-1\').style.display!=\'none\'){$(\'phase-1\').style.display=\'none\';this.innerHTML=\'[+]\';}else{$(\'phase-1\').style.display=\'block\';this.innerHTML=\'[&#8212;]\';}">[&#8212;]</a></h4><span style="display:none" id="phase-1">';aa=true;}
			break;
			case 1:
			if(ab===false){
			data += '</span><h4>Phase 1.2 Analyse the application &nbsp;&nbsp;<a class="toggle" href="javascript:void(0)" onclick="if($(\'phase-1.2\').style.display!=\'none\'){$(\'phase-1.2\').style.display=\'none\';this.innerHTML=\'[+]\';}else{$(\'phase-1.2\').style.display=\'block\';this.innerHTML=\'[&#8212;]\';}">[&#8212;]</a></h4><span style="display:none" id="phase-1.2">';ab=true;}
			break;		
			
			case 2:			
			if(ac===false){
			data += '</span></fieldset><fieldset class="c1"><legend>Phase 2</legend><h2>Phase 2. Test Client-Side Controls&nbsp;&nbsp;<a class="toggle" href="javascript:void(0)" onclick="if($(\'phase-2\').style.display!=\'none\'){$(\'phase-2\').style.display=\'none\';this.innerHTML=\'[+]\';}else{$(\'phase-2\').style.display=\'block\';this.innerHTML=\'[&#8212;]\';}">[&#8212;]</a></h4><span style="display:none" id="phase-2">';ac=true;}		
			break;
			
			case 3:
			if(b===false){data += '</fieldset><fieldset class="c2"><legend>Phase 3</legend></span><h2>Phase 3. Test Access Handling</h2><h4>Phase 3.1 &nbsp;&nbsp;Authentication Mechanism  &nbsp;&nbsp;<a class="toggle" href="javascript:void(0)" onclick="if($(\'phase-3\').style.display!=\'none\'){$(\'phase-3\').style.display=\'none\';this.innerHTML=\'[+]\';}else{$(\'phase-3\').style.display=\'block\';this.innerHTML=\'[&#8212;]\';}">[+]</a></h4><span style="display:none" id="phase-3">';b=true;}
			break;
			
			case 4:
			if(c===false){data += '</span><h4>Phase 3.2&nbsp;&nbsp; Session Management Mechanism &nbsp;&nbsp;<a class="toggle" href="javascript:void(0)" onclick="if($(\'phase-3.2\').style.display!=\'none\'){$(\'phase-3\').style.display=\'none\';this.innerHTML=\'[+]\';}else{$(\'phase-3.2\').style.display=\'block\';this.innerHTML=\'[&#8212;]\';}">[+]</a></h4><span style="display:none" id="phase-3.2">';c=true;}
			break;	
			
			case 5:
			if(d===false){data += '</span><h4>Phase 3.3&nbsp;&nbsp; Access Controls &nbsp;&nbsp;<a class="toggle" href="javascript:void(0)" onclick="if($(\'phase-3.3\').style.display!=\'none\'){$(\'phase-3.3\').style.display=\'none\';this.innerHTML=\'[+]\';}else{$(\'phase-3.3\').style.display=\'block\';this.innerHTML=\'[&#8212;]\';}">[+]</a></h4><span style="display:none" id="phase-3.3">';d=true;}
			break;			
			
			case 6:
			if(ea===false){data +='</fieldset><fieldset class="c3"><legend>Phase 4</legend></span><h2>Phase 4. Test Input Handling </h2><h4>Phase 4.1 Input-based Vulnerabilities&nbsp;&nbsp;<a class="toggle" href="javascript:void(0)" onclick="if($(\'phase-4\').style.display!=\'none\'){$(\'phase-4\').style.display=\'none\';this.innerHTML=\'[+]\';}else{$(\'phase-4\').style.display=\'block\';this.innerHTML=\'[&#8212;]\';}">[+]</a></h4><span style="display:none" id="phase-4">';ea=true;}
			break;				
			case 7:
			if(eb===false){data +='</span><h4>Phase 4.2 Function-Specific Input Vulnerabilities&nbsp;&nbsp;<a class="toggle" href="javascript:void(0)" onclick="if($(\'phase-4.2\').style.display!=\'none\'){$(\'phase-4.2\').style.display=\'none\';this.innerHTML=\'[+]\';}else{$(\'phase-4.2\').style.display=\'block\';this.innerHTML=\'[&#8212;]\';}">[+]</a></h4><span style="display:none" id="phase-4.2">';eb=true;}
			break;				
			case 8:
			if(f===false){data +='</fieldset><fieldset class="c4"><legend>Phase 5</legend></span><h2>Phase 5. Test Application Logic &nbsp;&nbsp;<a class="toggle" href="javascript:void(0)" onclick="if($(\'phase-5\').style.display!=\'none\'){$(\'phase-5\').style.display=\'none\';this.innerHTML=\'[+]\';}else{$(\'phase-5\').style.display=\'block\';this.innerHTML=\'[&#8212;]\';}">[+]</a></h2><span style="display:none" id="phase-5">';f=true;}
			break;				
			case 9:
			if(ga===false){data += '</fieldset><fieldset class="c5"><legend>Phase 6</legend></span><h2>Phase 6. Assess application hosting </h2><h4>Phase 6.1 Shared Hosting &nbsp;&nbsp;<a class="toggle" href="javascript:void(0)" onclick="if($(\'phase-6\').style.display!=\'none\'){$(\'phase-6\').style.display=\'none\';this.innerHTML=\'[+]\';}else{$(\'phase-6\').style.display=\'block\';this.innerHTML=\'[&#8212;]\';}">[+]</a></h4><span style="display:none" id="phase-6">';ga=true;}
			break;	
			case 10:
			if(gb===false){data += '</span><h4>Phase 6.2. Application Server &nbsp;&nbsp;<a class="toggle" href="javascript:void(0)" onclick="if($(\'phase-6.2\').style.display!=\'none\'){$(\'phase-6.2\').style.display=\'none\';this.innerHTML=\'[+]\';}else{$(\'phase-6.2\').style.display=\'block\';this.innerHTML=\'[&#8212;]\';}">[+]</a></h4><span style="display:none" id="phase-6.2">';gb=true;}
			break;				
			case 11:
			if(h===false){data += '</fieldset><fieldset class="c6"><legend>Miscellaneous</legend></span><h2>Miscellaneous tests &nbsp;&nbsp;<a class="toggle" href="javascript:void(0)" onclick="if($(\'phase-7\').style.display!=\'none\'){$(\'phase-7\').style.display=\'none\';this.innerHTML=\'[+]\';}else{$(\'phase-7\').style.display=\'block\';this.innerHTML=\'[&#8212;]\';}">[+]</a></h2><span style="display:none" id="phase-7">';h=true;}
			break;							
		}
		// used vars: rt, ck, vt, vk,  
		
		// used vars: rt, ck, vt, vk, lnk,note
			
		data += (i+1) + ". <input type='checkbox' onclick='if($(\"rt-" + i + "\").disabled==true){$(\"rt-" + i + "\").disabled=\"\";$(\"lnk-" + i + "\").className=\"strike\";$(\"rt-" + i + "\").focus();}else{$(\"lnk-" + i + "\").className=\"list\";$(\"rt-" + i + "\").disabled=\"disabled\";}' id='ck-" + i + "'\/><a class='list' id='lnk-"+i+"'  href='javascript:void(0)' onclick='if($(\"ck-" + i + "\").checked==1){$(\"lnk-" + i + "\").className=\"list\";$(\"ck-" + i + "\").checked=0;$(\"rt-" + i + "\").disabled=\"disabled\";}else{$(\"lnk-" + i + "\").className=\"strike\";$(\"ck-" + i + "\").checked=1;$(\"rt-" + i + "\").disabled=\"\";$(\"rt-" + i + "\").focus();}'>" + lst[i] + "</a>&nbsp;&nbsp;&nbsp;";		
		data += " &raquo; Vulnerable: <a href='javascript:void(0)' onclick='$(\"vkyes-" + i + "\").checked=\"1\";$(\"vt-" + i + "\").innerHTML=\"YES\"'><input type='radio' value='1' id='vkyes-" + i + "' name='vk-"    + i + "' /> YES</a>&nbsp;&nbsp; ";
                data +=                      "<a href='javascript:void(0)' onclick='$(\"vkno-"  + i + "\").checked=\"1\";$(\"vt-" + i + "\").innerHTML=\"NO\"'><input  type='radio' value='0' id='vkno-"  + i + "'   id='vkno-"  + i + "' name='vk-" + i + "' /> No </a>";
                data +=                      "<a href='javascript:void(0)' onclick='$(\"vktbd-" + i + "\").checked=\"1\";$(\"vt-" + i + "\").innerHTML=\"TBD\"'><input type='radio' value='2' id='vktbd-" + i + "'   id='vktbd-" + i + "' name='vk-" + i + "' checked='checked' /> TBD </a>";
                data += "&#8212; <a class='note' id='note-"+i+"' href='javascript:void(0)' onclick='if($(\"rt-" + i + "\").style.display==\"block\"){$(\"rt-" + i + "\").style.display=\"none\";}else{$(\"rt-" + i + "\").style.display=\"block\"}$(\"rt-" + i + "\").focus();' title='Toggle note/result for this test to include it in report'>Result/Note:</a><br \/>";
                data += "<textarea cols='100' rows='15' onkeyup='if(this.value.length>0){$(\"note-"+i+"\").innerHTML=\"Result/Note**\";}else{$(\"note-"+i+"\").innerHTML=\"Result/Note:\";}' id='rt-"+i+"' style='display:none' disabled='disabled'><\/textarea><span id='vt-"+i+"' style='display:none'><\/span><br\/>";
	}
	
	ck.innerHTML = data;
	$('btnStatus').disabled = '';$('btnReport').disabled = '';
    $('loading').style.display='none';$('site').focus();
    if(firstTime!==true){window.location='#end';firstTime=true;}     
        
}
function getstatus()
{
	var tot = lst.length;
	var checked = 0;
	for (var i=0;i<=document.getElementsByTagName("input").length-1;i++)
	{		
		if (document.getElementsByTagName("input")[i].type==='checkbox' && document.getElementsByTagName("input")[i].checked===1)
		{
			checked+=1;
		}
	}
	$('status').innerHTML = '&nbsp;'+Math.round((checked/tot)*100) + ' % completed&nbsp;';
}
function escapeHTML(value)
{
    function replaceChars(ch)
    {
        switch (ch)
        {
            case "<":
                return "&lt;";
            case ">":
                return "&gt;";
            case "&":
                return "&amp;";
            case "'":
                return "&#39;";
            case '"':
                return "&quot;";
        }
        return "?";
    };
    return String(value).replace(/[<>&"']/g, replaceChars);
}
var w = null;
var flaws_incat = new Array();

function toggle_exec_sum(flag)
{
	if(flag)
		$('exec_sum_place').innerHTML = '';
	else 
		$('exec_sum_place').innerHTML = '<textarea cols="85" rows="10" id="exec_sum" style="display:none"></textarea>';
}
function report()
{
    var site =$('site').value;
	//if (site=='http://'){alert('Please fill up target!');$('site').focus();return;}	
	var pentester =$('pentester').value;
	if (pentester===''){alert('Please fill up pentester!');$('pentester').focus();return;}	
	var pentester =$('pentester').value;
	site = site = escapeHTML(site);
	pentester = escapeHTML(pentester);
	var exec_sum = escapeHTML($('exec_sum').value);
	toggle_exec_sum(true);
	var d = new Date();
	var date = (d.getMonth()+1)+ '-' + d.getDate()  +'-'  +d.getFullYear();
	var tot = lst.length;
	var testno = 0;
	var flawno = 0;
	var flawindex = new Array();
	
	flaws_incat[9] = new Array();	
	for (var i=1;i<=9-1;i++){flaws_incat[i]=0;}
	var flaw_identified = false;
	var details = '';
	var html = '';
	
	for (var i=0;i<=document.getElementsByTagName("input").length-1;i++)
	{		
		if (document.getElementsByTagName("input")[i].type==='checkbox' && document.getElementsByTagName("input")[i].checked===1)
		{
			testno+=1;
		}	
	}
	var counterj = 1;
	for(var j=0;j<=document.getElementsByTagName("textarea").length-1;j++)
	{

		if ((!document.getElementsByTagName("textarea")[j].disabled) )
		{						

			if (($('vt-' + j ).innerHTML==='YES')&& (document.getElementsByTagName("textarea")[j].id!=='exec_sum') )
			{				
				var prob = lst[j];
				prob = prob.replace(/Test /,"");
				prob = prob.replace(/Check /,"");
				prob = prob.replace(/Do /,"");
				prob = prob.replace(/Identify /,"");
				prob = prob.replace(/Discover /,"");
				prob = prob.replace(/Understand /,"");
				prob = prob.replace(/for /g,"");
				prob = prob.replace(/Test for/g,"");
				prob = prob.replace(/the/g,"");
				prob = prob.replace(/any /g,"");
				prob = prob.replace(/Map /,"");
				prob = prob.replace(/Fuzz all /,"");				
				prob = prob.replace(/Follow up /,"");
				if(prob[0]===" ")
				{
					prob = prob.replace(/ /,"");
				}
				prob = prob[0].toUpperCase()+prob.substr(1,prob.length);
				details += 'Flaw ' + counterj + '. <span style="font-weight:bold;">' + prob + '</span>&nbsp;&nbsp;' + '&#8212; Refer to <span style="text-decoration:underline;"><a href="#test-' + (j+1) + '">Test ' + (j+1) + '</a></span><br \/>';
				details +='<br \/>';	
				flaw_identified = true;
				counterj++;			
			}

			
		}

	}
	if(flaw_identified===false)
	{
		details += '-None-';
	}		
	details += '<h3><span style="-moz-border-radius:2% 2% 2% 2%;padding:0% 1% 0% 1%;background-color:black;color:white;">&nbsp;Results Detailed&nbsp;&nbsp;</span></h3>';
	
	var a = false;var b=false;var c=false; var d = false;var e=false;var f=false;var g=false;var h = false;var i = false;
	
	for(var j=0;j<=document.getElementsByTagName("textarea").length-1;j++)
	{

		if ((!document.getElementsByTagName("textarea")[j].disabled))
		{
			var isvul = '';
			if (($('vt-' + j )) && ($('vt-' + j ).innerHTML==='YES') )
			{
				isvul = '<br/>Vulnerable? <span style="font-weight:bold;color:red">YES</span><br/>';		
				flawno+=1;
			}
			else if (($('vt-' + j )) && ($('vt-' + j ).innerHTML==='NO') )
			{
				isvul = '<br/>Vulnerable? <span style="font-weight:bold;">NO</span><br/>';
			}
			else
			{
				isvul = '<span></span>';
			}
		switch(key[lst[j]])
		{
			case 1:
			if(a===true){
				if (($('vt-' + j )) && ($('vt-' + j ).innerHTML==='YES') )
				{flaws_incat[1]+=1;}
			}					
			break;
			case 2:
			if(b===true){if (($('vt-' + j )) && ($('vt-' + j ).innerHTML==='YES') )
				{flaws_incat[2]+=1;}
				}
			break;
			case 3:
			if(c===true){if (($('vt-' + j )) && ($('vt-' + j ).innerHTML==='YES') )
				{flaws_incat[3]+=1;}
				}
			break;				
			case 4:
			if(d===true){if (($('vt-' + j )) && ($('vt-' + j ).innerHTML==='YES') )
				{flaws_incat[4]+=1;}
				}
			break;			
			case 5:
			if(e===true){if (($('vt-' + j )) && ($('vt-' + j ).innerHTML==='YES') )
				{flaws_incat[5]+=1;}
				}
			break;				
			case 6:
			if(f===true){if (($('vt-' + j )) && ($('vt-' + j ).innerHTML==='YES') )
				{flaws_incat[6]+=1;}
				}
			break;				
			case 7:
			if(g===true){if (($('vt-' + j )) && ($('vt-' + j ).innerHTML==='YES') )
				{flaws_incat[7]+=1;}
				}
			break;				
			case 8:
			if(h===true){if (($('vt-' + j )) && ($('vt-' + j ).innerHTML==='YES') )
				{flaws_incat[8]+=1;}
				}
			break;							
		}		
		switch(key[lst[j]])
		{
			case 1:
			if(a===false){
				details += '<h3>&#8224; Phase 1. ' + phase[0] + ' &#8224;</h3>';a=true;}		
			break;
			case 2:
			if(b===false){details += '<h3>&#8224; Phase 2.1 ' + phase[1] + ' &#8224;</h3>';b=true;}
			break;
			case 3:
			if(c===false){details += '<h3>&#8224; Phase 2.2 ' + phase[2] + ' &#8224;</h3>';c=true;}
			break;				
			case 4:
			if(d===false){details += '<h3>&#8224 Phase 2.3 ' + phase[3] + ' &#8224</h3>';d=true;}
			break;			
			case 5:
			if(e===false){details += '<h3>&#8224 Phase 3 ' + phase[4] + ' &#8224</h3>';e=true;}
			break;				
			case 6:
			if(f===false){details += '<h3>&#8224 Phase 4 ' + phase[5] + ' &#8224</h3>';f=true;}
			break;				
			case 7:
			if(g===false){details += '<h3>&#8224 Phase 5 ' + phase[6] + ' &#8224</h3>';g=true;}
			break;				
			case 8:
			if(h===false){details += '<h3>&#8224 ' + phase[7] + ' &#8224</h3>';h=true;}
			break;							
		}		

			if(lst[j])
			{
			//details += '<a name="test-' + (j+1) + '"></a>Test ' + (j+1) + '. <span style="font-weight:bold;">' + lst[j] + '</span><br />Vulnerable? ' + isvul +'<br \/>';
			details += '<a name="test-' + (j+1) + '"></a>Test ' + (j+1) + '. <span style="font-weight:bold;">' + lst[j] + '</span>' + isvul;
			if (document.getElementsByTagName("textarea")[j].value.length!==0)
			{
				var res = document.getElementsByTagName("textarea")[j].value;
				res = res.replace(/'/g,'&apos;');res = res.replace(/"/g,'&quot;');
				res = res.replace(/</g,'&lt;');res = res.replace(/>/g,'&gt;');
                res = res.replace(/\\/g,'\\');res = res.replace(/%0a/g,'<br/>');
                res = res.replace(/\n/g,'<br/>');

				details += 'Result/Note:<br \/><div style="padding:2% 2% 2% 2%;border:1px dashed;">' + res + '<\/div>';
			}
			details +='<br \/>';
			}
			
		}		
	}
//	alert(details);return;

	html = '<!DOCTYPE html PUBLIC"-//W3C//DTD XHTML 1.0 Transitional//EN""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>'+ site + ' | Web Application Security Assessment Report</title><style type="text/css">body{line-height:1.8em;padding:2% 3% 3% 3%;font-family:Georgia;}a{text-decoration:none;color:black;}.style1{-moz-border-radius:2% 2% 2% 2%;background-color:#000000;color:#FFFFFF;font-weight:bold;text-align:center;font-size:1.2em;}.style2{text-decoration:none;font-weight:bold}</style></head><body>';
	html +=  '<h1>Security Assessment for ' + site + '</h1><br/><table cellpadding="4" cellspacing="4"style="border:1px solid;"><tr><td colspan="2" class="style1">Summary</td></tr><tr><td width="42%">Target:&nbsp;</td><td width="58%">';
	html += '<a href="'+site+'" target="_blank" class="style2">'+site+'</a>';
	html += '</td></tr><tr><td>Methodology used:</td><td><strong>WAHH</strong></td></tr><tr><td>Number Of Tests:</td><td><strong>';
	html += testno;
	html += '</strong></td></tr><tr><td>Number Of Flaws:</td><td><strong>';
	html += flawno;
	html += '</strong></td></tr><tr><td>Date:<br/>(mm/dd/yyyy)</td><td><strong>';
	html += date;
	html += '</strong></td></tr><tr><td>Penetration Tester:</td><td><strong>';
	html += pentester;					
	if(exec_sum.length>1)
	{
		html += '</strong></td></tr></table><br/><h3><span style="-moz-border-radius:2% 2% 2% 2%;padding:0% 1% 0% 1%;background-color:black;color:white;">&nbsp;Executive Summary&nbsp;&nbsp;</span></h3>';
   		html += '<span style="padding:1% 1% 1% 1%">' + exec_sum+'<br/></span>';
   }
   else
   {
		html += '</strong></td></tr></table>';
   }	
   html += '<br/><h3><span style="-moz-border-radius:2% 2% 2% 2%;padding:0% 1% 0% 1%;background-color:black;color:white;">&nbsp;Problems Identified&nbsp;&nbsp;</span></h3>';	   
	html += details;
	html += '<br/></body></html>';								
	
	w = window.open('');	
	if(w===null){alert("Please allow popup!");return;}
	w.document.write(html);
	setTimeout("w.stop();",5000);
	toggle_exec_sum(false);
	$('exec_sum').value = exec_sum;
}

function reset()
{
	lst = new Array();
	lst = lst.concat(lst_bak);
	populate();
	/*for (var i=0;i<=document.getElementsByTagName("input").length-1;i++)
	{
		if (document.getElementsByTagName("input")[i].type=='checkbox')
		{
			document.getElementsByTagName("input")[i].checked=0;
		}
		if(document.getElementsByTagName("input")[i].type=='radio' && document.getElementsByTagName("input")[i].value==0)
		{
		 	document.getElementsByTagName("input")[i].checked=1;
		}	
	}
	
	for(var j=0;j<=document.getElementsByTagName("textarea").length-1;j++)
	{

		document.getElementsByTagName("textarea")[j].value="";
		document.getElementsByTagName("textarea")[j].disabled="disabled";
	}		
	for(var k=0;k<=document.getElementsByTagName("span").length-1;k++)
	{
		if(document.getElementsByTagName("span").value=="YES" || document.getElementsByTagName("span").value=="NO")
		{
			document.getElementsByTagName("span")[k].value="";		
		}		
	}*/	
}
function checkall()
{
	for (var i=0;i<=document.getElementsByTagName("input").length-1;i++)
	{
		if (document.getElementsByTagName("input")[i].type==='checkbox')
		{
		 	document.getElementsByTagName("input")[i].checked=1;
		}
				
	}	
	for(var j=0;j<=document.getElementsByTagName("textarea").length-1;j++)
	{	
		document.getElementsByTagName("textarea")[j].disabled="";
	}	
	
}

function addnew()
{
	var newtest = prompt("Enter your custom test.\nYour test will be added to Miscellenous tests.\n\n[Note. 1-line description]","","New Custom Test");
	
	if(newtest!==null && newtest!=="")
	{
		lst.push(newtest);		
		firstTime=false;
		populate();
	}
}
function exist_in_array(item,array)
{
var found=false;
  for(var i=0;i<=array.length;i++)
  {
     if (item === array[i])
     {
         found=true;
        break;
     }
     else {found=false;}
  }
 return found;
}
function delete_from_array(index)
{
	var newarray = new Array();
	index--;
	for(var j=0;j<=lst.length-1;j++)
	{
		if(j!==index)
		{
			newarray.push(lst[j]+"");				
		}		
	}		
	
	return newarray;
}

function delete_from_array1(index,storedarray)
{
	var newarray = new Array();
	index--;
	for(var j=0;j<=storedarray.length-1;j++)
	{
		if(j!==index)
		{
			newarray.push(storedarray[j]+"");				
		}		
	}		
	
	return newarray;
}

function deletetest()
{
	var testno = prompt("Enter your test number(s) to delete.\nSupported format:\n3\n1-10\n2,12,25 [ascending]","","New Custom Test");
	if(testno===null || testno===""){return;}
	
	
	if(testno.indexOf("-")>0)
	{
		var tofrom = testno.split("-");
		if(tofrom[1]<=tofrom[0]){alert("Invalid Numbers Pair!");return;}
		
		var howmany = tofrom[1]-tofrom[0];
		var start = tofrom[0]-1;
		lst.splice(start, howmany);		
			
	}	
	else if(testno.indexOf(",")>0)
	{
		var newlst = new Array();
		var delnos = testno.split(",");
		var deltimes = 0;
		var uselst = 0;
		var max = delnos.length;		
		for(var x=0;x<=delnos.length-1;x++)
		{		
			if(uselst===0)
			{
				newlst = delete_from_array(delnos[x]);				
				uselst=1;
				deltimes++;		
			}
			else 
			{
				newlst = delete_from_array1(delnos[x]-deltimes,newlst);
				deltimes++;	
			}		
									
		}
		
		lst = new Array();
		lst =lst.concat(newlst);		
	}
	else
	{
		var newlst = new Array();
		newlst = delete_from_array(testno);		
		lst = new Array();
		lst =lst.concat(newlst);
	}

	populate();	
}

function togglecollapse(showall)
{
	if(showall===true)
	{
		for(var p=0;p<=phase.length-1;p++)
		{
			var i = p+1;
			$('phase-'+i).style.display='';
		}
		for(var a=0;a<=document.getElementsByTagName("a").length-1;a++)
		{
			if(document.getElementsByTagName("a")[a].innerHTML.indexOf("[+]")!==-1)
			{
				document.getElementsByTagName("a")[a].innerHTML = '[&#8212;]';
			}
		}		
	}
	else
	{
		for(var p=0;p<=phase.length-1;p++)
		{
			var i = p+1;
			$('phase-'+i).style.display='none';
		}
		for(var a=0;a<=document.getElementsByTagName("a").length-1;a++)
		{
			if(document.getElementsByTagName("a")[a].innerHTML.indexOf("[�]")!==-1)
			{
				document.getElementsByTagName("a")[a].innerHTML = '[+]';
			}
		}		
	}
}

function disabletab()
{
	for (var i=0;i<=document.getElementsByTagName("textarea").length-1;i++)
	{	
	 	document.getElementsByTagName("textarea")[i].onkeypress = function(e){if(e.keyCode===9){this.value+="\t\t";return false;}};
	}	
}
onload = function(){ setTimeout("populate()",500);setTimeout("disabletab()",1000);};
</script>

</body>
</html>